{
  "chunk-44a4d13fd2fa5168f043e8cd0f9cbceb": {
    "tokens": 681,
    "content": "1**description** WTD WTD WTD :\nWTD\nQuery the achievement rate of sales within a certain period of time. The formula for the sales achievement rate is: sales amount / target sales amount - 1, and it is displayed as a percentage with two decimal places.\n\nWTD: this week (from last Sunday to  yesterday).\nMTD:this month (from the 1st of this month to yesterday).\nQTD: this quarter (from the start of this quarter to yesterday) .\nYTD: this year (from the start of this year to yesterday) .\nSelect the correct target fields required according to the user's questions:\n-F1 target:amt_notax_target_f1;\n-F2 target:amt_notax_target_f2;\n-F3 target:amt_notax_target_f3;\n-F4 target:amt_notax_target_f4.\nWTD sales vs Target\n\n**question sample**:\n-WTD / MTD / QTD / YTD sales vs Target?\n-what is the MTD sales achievement for China FP?\n-WTD / MTD / QTD / YTD sales vs F1 (target)? Means the target use the f1 target.\n\n**SQL query sample**:\n SELECT\n 'WTD' as period,\n SUM(amt_notax) as withouttax_amount,\n SUM(amt_notax_target) as target_amount,\n    case when SUM(amt_notax_target) = 0 then 0 else SUM(amt_notax)/SUM(amt_notax_target)-1 END as achievement\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between {1st of this week} AND CURRENT_DATE - INTERVAL '1 day'\n UNION ALL\n\n SELECT\n 'MTD'  as period,\n SUM(amt_notax) as withouttax_amount,\n SUM(amt_notax_target) as target_amount,\n    case when SUM(amt_notax_target) = 0 then 0 else SUM(amt_notax)/SUM(amt_notax_target)-1 END as achievement\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between TO_CHAR(DATE_TRUNC('MONTH', CURRENT_DATE), 'YYYY-MM-DD') AND CURRENT_DATE - INTERVAL '1 day'\n\n UNION ALL\n\n SELECT\n 'QTD' as period,\n SUM(amt_notax) as withouttax_amount,\n SUM(amt_notax_target) as target_amount,\n    case when SUM(amt_notax_target) = 0 then 0 else SUM(amt_notax)/SUM(amt_notax_target)-1 END as achievement\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between TO_CHAR(DATE_TRUNC(QUARTER', CURRENT_DATE), 'YYYY-MM-DD') AND CURRENT_DATE - INTERVAL '1 day'\n\n UNION ALL\n\n SELECT\n 'YTD' as period,\n SUM(amt_notax) as withouttax_amount,\n SUM(amt_notax_target) as target_amount,\n    case when SUM(amt_notax_target) = 0 then 0 else SUM(amt_notax)/SUM(amt_notax_target)-1 END as achievement\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between TO_CHAR(DATE_TRUNC('YEAR', CURRENT_DATE), 'YYYY-MM-DD') AND CURRENT_DATE - INTERVAL '1 day'\n;",
    "chunk_order_index": 0,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-8e77a76cc3f467a9c7ea017a9a605d32": {
    "tokens": 443,
    "content": "2**description**:\nQuery the sales growth in a certain week, including indicators such as sales amount, traffic, CR (Conversion Rate), AOV (Average Order Value), ASP (Average Selling Price), UPT (Units Per Transaction), etc. Of course, it's also possible to query only one of these indicators. The comparison formula is: sales amount of this week / sales amount of last week - 1, and it is displayed as a percentage with two decimal places.\n\n**question sample**:\nWeekly comp growth % for sales / traffic / CR / AOV / ASP / UPT.\nwhat is the weekly sales comp in week 34?\n\n**SQL query sample**:\n SELECT\n week_id,\n    SUM(amt) as sales_amt,\n SUM(amt_notax) as Sales_notax ,\n SUM(amt_notax)/SUM(lyd_amt_notax)-1 as sales_comp_per ,\n    SUM(traffic) as traffic,\n SUM(traffic)/SUM(lyd_traffic)-1 as traffic_comp_per ,\n SUM(case when traffic is not null  THEN trans else 0 END)/SUM(traffic) as CR ,\n SUM(case when traffic is not null  THEN trans else 0 END)/SUM(traffic)/(SUM(case when lyd_traffic is not null  THEN lyd_trans else 0 END)/SUM(lyd_traffic))-1 as cr_comp_per ,\n SUM(amt_notax)/SUM(trans) as AOV ,\n SUM(amt_notax)/SUM(trans)/(SUM(lyd_amt_notax)/SUM(lyd_trans))-1 as aov_comp_per ,\n SUM(amt_notax)/SUM(qty) as ASP,\n SUM(amt_notax)/SUM(qty)/(SUM(lyd_amt_notax)/SUM(lyd_qty))-1 as asp_comp_per ,\n SUM(qty)/SUM(trans) as UPT ,\n SUM(qty)/SUM(trans)/(SUM(lyd_qty)/SUM(lyd_trans))-1 as UPT_comp_per\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    week_id ='202534'\n    AND comp_flag ='Y' -- The store participating in the comp.\n GROUP BY\n    week_id\n;",
    "chunk_order_index": 1,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-6ccc3dc49eff6478f996913190bc209f": {
    "tokens": 185,
    "content": "3**description**:\nQuery the sales growth situation for a specific month, and certain conditions such as countries and channels can be specified. The comparison formula is: sales of this month / sales of last month - 1, and it is displayed as a percentage with two decimal places.\n\n**question sample**:\nWhat is the sales MOM% for APAC EC?\n\n**SQL query sample**:\n SELECT\n month_id,\n    SUM(amt) as sales_amt,\n SUM(amt_notax) as Sales_notax ,\n SUM(amt_notax)/SUM(lm_amt_notax)-1 as sales_notax_mom_per\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between TO_CHAR(DATE_TRUNC('MONTH', CURRENT_DATE), 'YYYY-MM-DD') AND TO_CHAR(DATEADD(day, -1, CURRENT_DATE), 'YYYY-MM-DD')\n GROUP BY\n    month_id\n;",
    "chunk_order_index": 2,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-323320f36bc5fcbd343c99b79167f2cb": {
    "tokens": 221,
    "content": "4**description**:\nQuery the achievement rate of sales within a certain period of time. The formula for the sales achievement rate is: sales amount / target sales amount - 1, and it is displayed as a percentage with two decimal places.\n\n**question sample**:\nWhat is the % to go to achieve the month revenue?\n\n**SQL query sample**:\n SELECT\n TO_CHAR(CURRENT_DATE, 'YYYY-MM') AS title,\n    SUM(amt) as amt,\n SUM(amt_notax) as amt_notax ,\n SUM(amt_notax_target) as amt_notax_target,\n case when SUM(amt_notax_target) = 0 then 0 else SUM(amt_notax)/SUM(amt_notax_target)-1 END as amt_ach\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code BETWEEN TO_CHAR(DATE_TRUNC('MONTH', CURRENT_DATE), 'YYYY-MM-DD') AND TO_CHAR(DATEADD(day, -1, CURRENT_DATE), 'YYYY-MM-DD')\n GROUP BY\n    TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n;",
    "chunk_order_index": 3,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-ece6d710fb043d84588d12b74234dcac": {
    "tokens": 423,
    "content": "5**description**:\nQuery the sales growth in a certain week, including indicators such as sales amount, traffic, CR (Conversion Rate), AOV (Average Order Value), ASP (Average Selling Price), UPT (Units Per Transaction), etc. Of course, it's also possible to query only one of these indicators. The comparison formula is: sales amount of this week / sales amount of last week - 1, and it is displayed as a percentage with two decimal places.\n\n**question sample**:\nWoW growth% of sales / traffic / CR / AOV / ASP / UPT\n\n**SQL query sample**:\n SELECT\n week_id,\n    SUM(amt) as amt,\n SUM(amt_notax) as amt_notax ,\n SUM(amt_notax)/SUM(lw_amt_notax)-1 as sales_notax_wow_per ,\n    SUM(traffic) as traffic,\n SUM(traffic)/SUM(lw_traffic)-1 as traffic_wow_per ,\n SUM(case when traffic is not null  THEN trans else 0 END)/SUM(traffic) as CR ,\n SUM(case when traffic is not null  THEN trans else 0 END)/SUM(traffic)/(SUM(case when lw_traffic is not null  THEN lw_trans else 0 END)/SUM(lw_traffic))-1 as cr_wow_per ,\n SUM(amt_notax)/SUM(trans) as AOV ,\n SUM(amt_notax)/SUM(trans)/(SUM(lw_amt_notax)/SUM(lw_trans))-1 as aov_wow_per ,\n SUM(amt_notax)/SUM(qty) as ASP,\n SUM(amt_notax)/SUM(qty)/(SUM(lw_amt_notax)/SUM(lw_qty))-1 as asp_wow_per ,\n SUM(qty)/SUM(trans) as UPT ,\n SUM(qty)/SUM(trans)/(SUM(lw_qty)/SUM(lw_trans))-1 as UPT_wow_per\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between {1st of this week} AND {Today}\n GROUP BY\n    week_id\n;",
    "chunk_order_index": 4,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-46717d23ed24c265e22997d8c86bc689": {
    "tokens": 448,
    "content": "6**description**:\nQuery the sales growth in a certain month, including indicators such as sales amount, traffic, CR (Conversion Rate), AOV (Average Order Value), ASP (Average Selling Price), UPT (Units Per Transaction), etc. Of course, it's also possible to query only one of these indicators. The comparison formula is: sales amount of this month / sales amount of last month - 1, and it is displayed as a percentage with two decimal places.\n\n**question sample**:\nMoM growth% of sales / traffic / CR / AOV / ASP / UPT\n\n**SQL query sample**:\n SELECT\n month_id,\n    SUM(amt) as amt,\n SUM(amt_notax) as amt_notax ,\n SUM(amt_notax)/SUM(lm_amt_notax)-1 as amt_notax_mom_per ,\n    SUM(traffic) as traffic,\n SUM(traffic)/SUM(lm_traffic)-1 as traffic_mom_per ,\n SUM(case when traffic is not null  THEN trans else 0 END)/SUM(traffic) as CR ,\n SUM(case when traffic is not null  THEN trans else 0 END)/SUM(traffic)/(SUM(case when lm_traffic is not null  THEN lm_trans else 0 END)/SUM(lm_traffic))-1 as cr_mom_per ,\n SUM(amt_notax)/SUM(trans) as AOV ,\n SUM(amt_notax)/SUM(trans)/(SUM(lm_amt_notax)/SUM(lm_trans))-1 as aov_mom_per ,\n SUM(amt_notax)/SUM(qty) as ASP,\n SUM(amt_notax)/SUM(qty)/(SUM(lm_amt_notax)/SUM(lm_qty))-1 as asp_mom_per ,\n SUM(qty)/SUM(trans) as UPT ,\n SUM(qty)/SUM(trans)/(SUM(lm_qty)/SUM(lm_trans))-1 as UPT_mom_per\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between TO_CHAR(DATE_TRUNC('MONTH', CURRENT_DATE), 'YYYY-MM-DD') AND TO_CHAR(DATEADD(day, -1, CURRENT_DATE), 'YYYY-MM-DD')\n GROUP BY\n    month_id\n;",
    "chunk_order_index": 5,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-215015657fed07b0b7cb11691f789f0e": {
    "tokens": 308,
    "content": "7**description**:\nCalculate the sales proportion according to the division attribute of the product, and at the same time compare it with the sales proportion of last week. Of course, it's also possible to only query the sales proportion. The sales proportion is displayed as a percentage with two decimal places.\n\n**question sample**:\nSOB of APP / FTW / ACCS and how does it compare to last week?\n\n**SQL query sample**:\nWITH DivisionSales AS (\n SELECT\n division,\n    SUM(amt) as TotalAmount,\n    SUM(lw_amt) as LWTotalAmount\n FROM\n    dm_fact_sales_sku_chatbi\n WHERE\n date_code  Between {1st of this week} AND {Today}\n    AND division in ('Apparel','Footwear','Accessories')\n GROUP BY\n    division\n ),\n TotalSales AS (\n    SELECT\n        SUM(TotalAmount) AS GrandTotal,\n  SUM(LWTotalAmount) AS LWGrandTotal\n    FROM\n        DivisionSales\n)\nSELECT\n    ds.division,\n    ds.TotalAmount,\n    CAST(ds.TotalAmount / ts.GrandTotal * 100.0 as decimal(7,2))  ||'%' AS PercentageOfTotal,\n ds.LWTotalAmount,\n    CAST(ds.LWTotalAmount / ts.LWGrandTotal * 100.0 as decimal(7,2))  ||'%' AS LWPercentageOfTotal\n FROM\n    DivisionSales ds,\n    TotalSales ts\n ORDER BY\n    ds.TotalAmount DESC;",
    "chunk_order_index": 6,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-a7c59845f68cba3f6c7aa283a00c6151": {
    "tokens": 311,
    "content": "8**description**:\nCalculate the sales proportion according to certain key attributes of the products, and at the same time compare it with the proportions of sales amount and sales quantity of last week. Of course, it's also possible to only query the proportion of sales amount or the proportion of sales quantity. The proportion of sales amount is displayed as a percentage with two decimal places.\n\n**question sample**:\nKey category sales SOB / Unit SOB and its performance vs  last week.\n\n**SQL query sample**:\nWITH categorySales AS (\n SELECT\n key_stories,\n    SUM(amt) as TotalAmount,\n    SUM(lw_amt) as LWTotalAmount\n FROM\n    dm_fact_sales_sku_chatbi\n WHERE\n date_code  Between {1st of this week} AND {Today}\n GROUP BY\n    key_stories\n ),\n TotalSales AS (\n    SELECT\n        SUM(TotalAmount) AS GrandTotal,\n  SUM(LWTotalAmount) AS LWGrandTotal\n    FROM\n        categorySales\n)\nSELECT\n    ds.key_stories,\n    ds.TotalAmount,\n    CAST(ds.TotalAmount / ts.GrandTotal * 100.0 as decimal(7,2))  ||'%' AS PercentageOfTotal,\n ds.LWTotalAmount,\n    CAST(ds.LWTotalAmount / ts.LWGrandTotal * 100.0 as decimal(7,2))  ||'%' AS LWPercentageOfTotal\n FROM\n    categorySales ds,\n    TotalSales ts\n ORDER BY\n    ds.TotalAmount DESC;",
    "chunk_order_index": 7,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-fe1b6dd1169eb6721eead80e97431213": {
    "tokens": 456,
    "content": "9**description**:\nQuery the sales proportion situation of MFO products. The sales proportion is displayed as a percentage with two decimal places.\n\n**question sample**:\nWhat is the MFO% in week 27? How does it compare to last week and last year average?\n\n**SQL query sample**:\nWITH MFOSales202527 AS ( SELECT 'MFO' AS title, SUM ( amt ) AS mfo_amt FROM dm_fact_sales_sku_chatbi WHERE\nweek_id = '202527' AND product_line = 'MFO' ),\nTotalSales202527 AS ( SELECT 'Total' AS title, SUM ( amt ) AS total_amt FROM dm_fact_sales_sku_chatbi WHERE\n week_id = '202527' ),\nMFOSales202526 AS ( SELECT SUM ( amt ) AS mfo_amt FROM dm_fact_sales_sku_chatbi WHERE\n week_id = '202526' AND product_line = 'MFO' ),\nTotalSales202526 AS ( SELECT SUM ( amt ) AS total_amt FROM dm_fact_sales_sku_chatbi WHERE\n week_id = '202526' ),\nMFOSalesly AS ( SELECT SUM ( amt ) AS mfo_amt FROM dm_fact_sales_sku_chatbi WHERE\n year_id = '2024' AND product_line = 'MFO' ),\nTotalSalesly AS ( SELECT SUM ( amt ) AS total_amt FROM dm_fact_sales_sku_chatbi WHERE\n year_id = '2024' ) SELECT\n( SELECT CASE WHEN TotalSales202527.total_amt = 0 THEN 0 ELSE MFOSales202527.mfo_amt / TotalSales202527.total_amt END  FROM MFOSales202527, TotalSales202527 ) AS MFO_amt_per202527,\n( SELECT CASE WHEN TotalSales202526.total_amt = 0 THEN 0 ELSE MFOSales202526.mfo_amt / TotalSales202526.total_amt END  FROM MFOSales202526, TotalSales202526 ) AS MFO_amt_per202526,\n( SELECT CASE WHEN TotalSalesly.total_amt = 0 THEN 0 ELSE MFOSalesly.mfo_amt / TotalSalesly.total_amt END  FROM MFOSalesly, TotalSalesly ) AS MFO_amt_perlastyear\n;",
    "chunk_order_index": 8,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-657ec00766b920c166780b3c3e32b930": {
    "tokens": 222,
    "content": "10**description**:\nQuery the sales and target on store code or store name  and calculate the achievement rate.\nThe formula for the sales achievement rate is: sales amount / target sales amount - 1, and it is displayed as a percentage with two decimal places.\n\n**question sample**:\nWhat was yesterday sales on store '1234'? Does it meet sales target?\n\n**SQL query sample**:\n SELECT\n date_code,\n store_code,\n store_name,\n    SUM(amt) as sales_amt,\n SUM(amt_notax) as Sales_notax ,\n SUM(amt_notax_target),\n case when SUM(amt_notax_target) = 0 then 0 else SUM(amt_notax)/SUM(amt_notax_target)-1 END as amt_ach\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code = TO_CHAR(DATEADD(day, -1, CURRENT_DATE), 'YYYY-MM-DD')\n    AND (store_code like '%1234%'\n     OR store_name like '%1234%' )\n GROUP BY\n    date_code,\n store_code,\n store_name\n ;",
    "chunk_order_index": 9,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-87c4c7bd85742058d4fb3fb7368545c6": {
    "tokens": 193,
    "content": "11**description**:\nQuery the store which has the best wow sales growth%.\n\n**question sample**:\nWhich store has the best wow sales growth%?\n\n**SQL query sample**:\n SELECT\n    top 5\n week_id,\n store_code,\n store_name,\n    SUM(amt) as sales_amt,\n SUM(amt_notax) as Sales_notax ,\n SUM(lw_amt_notax) as LW_sales_notax ,\n case when SUM(lw_amt_notax) =0 then 0 else  SUM(amt_notax)/SUM(lw_amt_notax)-1 end as sales_notax_wow_per\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between {1st of this week} AND {Today}\n AND lw_amt_notax >0\n    AND amt_notax >0\n GROUP BY\n    week_id,\n store_code,\n store_name\n ORDER BY\n    sales_notax_wow_per DESC\n;",
    "chunk_order_index": 10,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-6c676d02a46f0ee58a25585c6cf4e752": {
    "tokens": 194,
    "content": "12**description**:\nQuery the store which  has the worst wow sales growth%.\n\n**question sample**:\nWhich store has the worst wow sales growth%?\n\n**SQL query sample**:\n SELECT\n    top 5\n week_id,\n store_code,\n store_name,\n    SUM(amt) as sales_amt,\n SUM(amt_notax) as Sales_notax ,\n SUM(lw_amt_notax) as LW_sales_notax ,\n case when SUM(lw_amt_notax) =0 then 0 else  SUM(amt_notax)/SUM(lw_amt_notax)-1 end as sales_notax_wow_per\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between {1st of this week} AND {Today}\n AND lw_amt_notax >0\n    AND amt_notax >0\n GROUP BY\n    week_id,\n store_code,\n store_name\n ORDER BY\n    sales_notax_wow_per ASC\n;",
    "chunk_order_index": 11,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-34bd968ebf3c5c6de3ec30724f3c540c": {
    "tokens": 111,
    "content": "13**description**:\nQuery the product categories that contribute significantly to the weekly sales.\n\n**question sample**:\nWhich category drive China BH revenue in week 27?\n\n**SQL query sample**:\n SELECT\n    top 5\n key_stories,\n    SUM(amt) as sales_amt\n FROM\n    dm_fact_sales_sku_chatbi\n WHERE\n    week_id ='202527'\n AND country = 'Mainland'\n AND store_type = 'BH'\n GROUP BY\n key_stories\n ORDER BY\n    SUM(amt) DESC\n;",
    "chunk_order_index": 12,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-318e05213fba67f7b6a114f0cdca5a84": {
    "tokens": 440,
    "content": "14**description**:\nQuery the sell-through rate of the product as of today.\nQuery the sell through of the weekly frequency of commodities.\nsell-through: sales units( from last Sunday to today ) /(Inventory quantity of last Saturday + sales units( from last Sunday to today )),Display with two decimal places in percentage..\n\n**question sample**:\nWhat is the sell-through of 'CURRY' as of today?\n'CURRY' could be the product's name, division, category, or material.\n\n**SQL query sample**:\nWith salesQty as (\n SELECT\n product_name,\n    SUM(qty) as sales_units\n FROM\n    dm_fact_sales_sku_chatbi\n WHERE\n    date_code between {1st of this week} AND {today}\n AND (\n     product_name like '%CURRY%' OR\n  division like '%CURRY%' OR\n  key_stories like '%CURRY%' OR\n  material like '%CURRY%'\n )\n GROUP BY\n product_name\n),\nInvOfLastSaturday as (\n-- Get the onhand inventory of the most recent Saturday before the transaction starts.\n  SELECT\n country,\n    SUM(stock) as onhand_inv\n FROM\n    dm_fact_onhand_chatbi\n WHERE\n    date_code =\n(Select\n TO_CHAR(MAX(date_code),'YYYY-MM-DD') -- edw_dim_calendar.date_code:type of date;dm_fact_onhand_chatbi.date_code:type of String(YYYY-MM-DD).\n FROM edw_dim_calendar\n WHERE\n date_code <{today} AND weekday_name ='Saturday')\n AND (\n     product_name like '%CURRY%' OR\n  division like '%CURRY%' OR\n  key_stories like '%CURRY%' OR\n  material like '%CURRY%'\n )\n GROUP BY\n product_name\n)\n Select\n sales.product_name,\n sales.sales_units,\n stock.onhand_inv,\n CASE WHEN stock.onhand_inv = 0 THEN 0 ELSE CAST(sales.sales_units*100.00/stock.onhand_inv as decimal(18,2)) END || '%' as sell_through\n FROM salesQty sales inner join InvOfLastSaturday stock\n on sales.product_name = stock.product_name\n;",
    "chunk_order_index": 13,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-8544c4710e38a3bd8900e1e5e55008c1": {
    "tokens": 270,
    "content": "15**description**:\nQuery the number of stores that have reached their weekly sales targets and calculate the percentage.\nDisplay with two decimal places in percentage.\n\n**question sample**:\nHow many stores reach weekly sales target? Absolute store count and % of total\n\n**SQL query sample**:\nWITH StoreSales AS (\n SELECT\n store_code,\n    SUM(amt_notax) as TotalAmountNet,\n    SUM(amt_notax_target) as TotalTargetNet\n FROM\n    dm_fact_sales_chatbi\n WHERE\n date_code  Between {1st of this week} AND TO_CHAR(DATEADD(day, -1, CURRENT_DATE), 'YYYY-MM-DD')\n GROUP BY\n    store_code\n ),\n ReachStore AS (\n    SELECT\n        count(DISTINCT store_code) as reachcount\n    FROM\n        StoreSales\n WHERE\n     TotalAmountNet>=TotalTargetNet\n),\n ALLStore AS (\n    SELECT\n        count(DISTINCT store_code) as allcount\n    FROM\n        StoreSales\n)\nSELECT\n    ds.reachcount as reached_store,\n    ts.allcount as all_store,\n    CAST(ds.reachcount*1.00 / ts.allcount*100.0 as decimal(7,2)) ||'%' AS PercentageOfTotal\n FROM\n    ReachStore ds,\n    ALLStore ts;",
    "chunk_order_index": 14,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-28da327421b6cfdbcddb10d800dc8c4c": {
    "tokens": 437,
    "content": "16**description**:\nQuery the discount level of this week.\nAnd show the Comparison to last week and last year channel average.\n\n**question sample**:\nWhat is the discount level of this week? How does it compare to last week and last year channel average?\n\n**SQL query sample**:\nWith twdis as (\n    SELECT\n week_id,\n channel,\n    SUM(amt)/SUM(orig_price)-1 as tw_discount\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between {1st of this week} AND {Today}\n GROUP BY\n    week_id,\n channel\n),\n    Lwdis as (\n SELECT\n channel,\n    SUM(amt)/SUM(orig_price)-1 as lw_discount\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between DATEADD(day,-7,{last Sunday}) AND DATEADD(day,-7,TO_CHAR(DATEADD(day, -1, CURRENT_DATE), 'YYYY-MM-DD'))\n GROUP BY\n channel\n),\nLMdis as (\n    SELECT\n channel,\n    SUM(amt)/SUM(orig_price)-1 as lm_discount\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between DATEADD(month,-1,{1st of this week}) AND DATEADD(month,-1,TO_CHAR(DATEADD(day, -1, CURRENT_DATE), 'YYYY-MM-DD'))\n GROUP BY\n channel\n),\nLYdis as (\nSELECT\n channel,\n    SUM(amt)/SUM(orig_price)-1 as ly_discount\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code Between DATEADD(year,-1,{1st of this week}) AND DATEADD(year,-1,TO_CHAR(DATEADD(day, -1, CURRENT_DATE), 'YYYY-MM-DD'))\n GROUP BY\n channel\n)\n\n SELECT\n tw.week_id,\n tw.channel,\n    tw.tw_discount ,\n lw.lw_discount ,\n lm.lm_discount ,\n    ly.ly_discount\n FROM\n    twdis tw left join lwdis lw on tw.channel=lw.channel\n    left join lmdis lm on tw.channel=lm.channel\n    left join lydis ly on tw.channel=ly.channel\n;",
    "chunk_order_index": 15,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-2b96f8a403e0c1eff91d73c4ba2f3852": {
    "tokens": 121,
    "content": "17**description**:\nQuery the number of opening stores as of a date.\n\n**question sample**:\nHow many opening stores do we have as of yyyymmdd?\n\n**SQL query sample**:\n SELECT\n    store.country,\n count(store.store_code) as storecount\n FROM\n    edw_dim_store_prod store inner join edw_dim_calendar calendar\n on store.date_sid = calendar.date_sid\n WHERE\n    calendar.date_code = 'yyyy-mm-dd'\n    AND store.open_flag ='open'\n GROUP BY\n    store.country\n ORDER BY\n    count(store.store_code) DESC\n;",
    "chunk_order_index": 16,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-4c7d700fc24244d8591243053236229d": {
    "tokens": 129,
    "content": "18**description**:\nQuery the number of comp stores as of a date.\n\n**question sample**:\nHow many comp stores do we have as of yyyymmdd?\n\n**SQL query sample**:\n SELECT\n    store.country,\n count(store.store_code) as storecount\n FROM\n    edw_dim_store_prod store inner join edw_dim_calendar calendar\n on store.date_sid = calendar.date_sid\n WHERE\n    calendar.date_code = 'yyyy-mm-dd'\n    AND store.comp_flag ='Y' -- The store participating in the comp.\n GROUP BY\n    store.country\n ORDER BY\n    count(store.store_code) DESC\n;",
    "chunk_order_index": 17,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-3eba47b965db367686d4c29b285e7b7d": {
    "tokens": 220,
    "content": "19**description**:\nQuery the average store size .\n\n**question sample**:\nWhat is average China BH store size in FY24? What is average China BH comp store size in FY24?\n\n**SQL query sample**:\n SELECT\n    'FY24store' as title,\n AVG(store.area) as storearea\n FROM\n    edw_dim_store_prod store inner join edw_dim_calendar calendar\n on store.date_sid = calendar.date_sid\n WHERE\n    calendar.date_code between '2023-04-01' AND '2024-03-31'\n AND store.store_type = 'BH'\n UNION ALL\n SELECT\n    'FY24compstore' as title,\n AVG(store.area) as storearea\n FROM\n    edw_dim_store_prod store inner join edw_dim_calendar calendar\n on store.date_sid = calendar.date_sid\n WHERE\n    calendar.date_code between '2023-04-01' AND '2024-03-31'\n AND store.store_type = 'BH'\n AND store.comp_flag = 'Y' -- The store participating in the comp.\n;",
    "chunk_order_index": 18,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-80feb7f9baa0e4d493fb4e9c682b6822": {
    "tokens": 178,
    "content": "20**description**:\nQuery the number of the new stores.\nThe store information in edw_dim_store_prod is at a daily granularity, meaning the store information is repeated daily.\n\n**question sample**:\nHow many new stores do we have in FY24?\n\n**SQL query sample**:\nWith openstore as (\n    SELECT\n store.store_master_code,\n min(store.open_date) as open_date\n FROM\n    edw_dim_store_prod store inner join edw_dim_calendar calendar\n on store.date_sid = calendar.date_sid\n WHERE\n    calendar.date_code between '2023-04-01' AND '2024-03-31'\n GROUP BY\n    store.store_master_code\n)\n SELECT\n count(store_master_code)\n FROM\n    openstore\n WHERE\n    open_date between '2023-04-01' AND '2024-03-31'\n;",
    "chunk_order_index": 19,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-7acc96b4208534be2573509b9b3acb9f": {
    "tokens": 194,
    "content": "21**description**:\nQuery the sales and target for stores , and calculate the achievement rate.\namt_ach >0 : achieve the target；\namt_ach <0 :did not achieve the target.\n\n**question sample**:\nWhich stores did not meet sales target last week?\n\n**SQL query sample**:\n SELECT\n store_code,\n store_name,\n    SUM(amt) as sales_amt,\n SUM(amt_notax) as Sales_notax ,\n SUM(amt_notax_target) as amt_notax_target,\n case when SUM(amt_notax_target) = 0 then 0 else SUM(amt_notax)/SUM(amt_notax_target)-1 END as amt_ach\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code between  {last last Sunday} and {last Saturday}\n GROUP BY\n store_code,\n store_name\n HAVING\n    amt_ach >0\n ORDER BY\n    amt_ach desc\n;",
    "chunk_order_index": 20,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  },
  "chunk-84e6029b32df619a952ad30929d009a2": {
    "tokens": 203,
    "content": "22**description**:\nQuery the sales and target for stores , and calculate the achievement rate.\nQuery the sales performance after the store opened .\n\n**question sample**:\nDo we have any new store opened last week? When did it open and how did it perform?\n\n**SQL query sample**:\n SELECT\n store_code,\n store_name,\n open_date,\n    SUM(amt) as sales_amt_ToNow,\n SUM(amt_notax) as Sales_notax ,\n SUM(amt_notax_target) as amt_notax_target,\n case when SUM(amt_notax_target) = 0 then 0 else SUM(amt_notax)/SUM(amt_notax_target)-1 END as amt_ach\n FROM\n    dm_fact_sales_chatbi\n WHERE\n    date_code >= {last last Sunday}\n    AND open_date between  {last last Sunday} and {last Saturday}\n GROUP BY\n store_code,\n store_name,\n open_date\n ORDER BY\n    SUM(amt) desc\n;\n\n(****)",
    "chunk_order_index": 21,
    "full_doc_id": "doc-7185033adc1c850871145b3a857022b6"
  }
}